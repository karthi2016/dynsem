module coercion

imports
  include/ds
  analysis/lib-analysis
  analysis/constructors


rules
  
  coerce:
    (ty, ty) -> ty
  
  coerce:
    (SType(s1), SType(s2)) -> SType(s2)
    where
      <lookup-prop(|ParentSort())> (Sorts(), s1) => s2
  
  coerce:
    (LType(s1), LType(s2)) -> LType(<coerce> (s1, s2))
  
  coerce:
    (MType(k1, v1), MType(k2, v2)) -> MType(<coerce> (k1, k2), <coerce> (k2, v2))
  