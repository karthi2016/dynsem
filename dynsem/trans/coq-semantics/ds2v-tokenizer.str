module coq-semantics/ds2v-tokenizer

signature

  sorts DS2V constructors
    imports : String -> DS2V

rules

  ds2v-tokenize:
    path -> token_list
    with
      (ds2v_file := <guarantee-extension(|"ds2v")> path;
       <file-exists> ds2v_file;
       token_list := <read-text-file;
                      string-tokenize(|['\n']);
                      map(string-tokenize(|[':']);
                          (  \ [kind, a, b] -> (kind, a, b) \
                          <+ \ [x] -> (<read-from-string> x) \ )
                         )> ds2v_file
      ) <+
      token_list := []